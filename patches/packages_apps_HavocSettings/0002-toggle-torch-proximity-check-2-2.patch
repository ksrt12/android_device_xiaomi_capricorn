From cc09c55c450c9ed82bfda68b8a707b2fca09a8e9 Mon Sep 17 00:00:00 2001
From: Kazakov Stepan <ksrt12group@gmail.com>
Date: Tue, 22 Jan 2019 12:31:50 +0300
Subject: [PATCH 2/2] toggle torch proximity check [2/2]

Signed-off-by: Kazakov Stepan <ksrt12group@gmail.com>
---
 res/values-ru/havoc_strings.xml    | 8 ++++++--
 res/values/havoc_strings.xml       | 2 ++
 res/xml/havoc_settings_buttons.xml | 7 +++++++
 3 files changed, 15 insertions(+), 2 deletions(-)

diff --git a/res/values-ru/havoc_strings.xml b/res/values-ru/havoc_strings.xml
index 1c19e03..3884720 100644
--- a/res/values-ru/havoc_strings.xml
+++ b/res/values-ru/havoc_strings.xml
@@ -600,8 +600,12 @@
     <string name="qs_footer_warnings_title">Предупреждение в нижней части быстрых настроек</string>
     <string name="qs_footer_warnings_summary">Показывать предупреждение в нижней панели быстрых настроек, когда сеть контролируется сторонними приложениями или VPN</string>
     <string name="hardware_keys_power_category">Кнопка питания</string>
-    <string name="torch_long_press_power_gesture_title">Включение фонарика долгим нажатием кнопки питания</string>
-    <string name="torch_long_press_power_gesture_desc">Включать фонарик долгим нажатием кнопки питания при выключенном экране</string>
+    <string name="power_button_torch_gesture_title">Включение фонарика нажатием кнопки питания</string>
+    <string name="power_button_torch_gesture_none">Отключено</string>
+    <string name="power_button_torch_gesture_dt">Двойное нажатие</string>
+    <string name="power_button_torch_gesture_lp">Долгое нажатие</string>
+    <string name="power_button_torch_check_title">Проверка датчика приближения</string>
+    <string name="power_button_torch_check_desc">Проверять датчик приближения перед ключением фонарика</string>
     <string name="torch_long_press_power_timeout_title">Автоматическое выключение фонарика</string>
     <string name="torch_long_press_power_timeout_never">Никогда</string>
     <string name="torch_long_press_power_timeout_1min">1 минутa</string>
diff --git a/res/values/havoc_strings.xml b/res/values/havoc_strings.xml
index 81d9fa5..abbbf34 100644
--- a/res/values/havoc_strings.xml
+++ b/res/values/havoc_strings.xml
@@ -667,6 +667,8 @@
     <string name="qs_footer_warnings_summary">Display a warning when network is monitored by external apps or vpn</string>
 
     <string name="hardware_keys_power_category">Power Button</string>
+    <string name="power_button_torch_check_title">Proximity check for torch</string>
+    <string name="power_button_torch_check_desc">Check proximity sensor before turning on the flashlight</string>
     <string name="power_end_call_title">End call</string>
     <string name="power_end_call_summary">End the current call by pressing the power button</string>
 
diff --git a/res/xml/havoc_settings_buttons.xml b/res/xml/havoc_settings_buttons.xml
index 40ac532..c0d4718 100644
--- a/res/xml/havoc_settings_buttons.xml
+++ b/res/xml/havoc_settings_buttons.xml
@@ -63,6 +63,13 @@
             android:entries="@array/power_button_torch_gesture_entries"
             android:entryValues="@array/power_button_torch_gesture_values" />
 
+        <com.havoc.support.preferences.SystemSettingSwitchPreference
+            android:key="power_button_torch_check"
+            android:title="@string/power_button_torch_check_title"
+            android:summary="@string/power_button_torch_check_desc"
+            android:dependency="torch_power_button_gesture"
+            android:defaultValue="false" />
+
     </PreferenceCategory>
 
     <PreferenceCategory
-- 
2.20.1

